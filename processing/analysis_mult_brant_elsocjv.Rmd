---
title: |
  ![](../input/images/logo-sociales.jpg){width=25% height=25%}  
  Documento de análisis multivariado - ¿Quién justifica qué? El rol del sentido de injusticia en las justificaciones de violencia en contexto de protesta
author: 
  - Martin Venegas Márquez
date: "`r format(Sys.Date(), '%d/%m/%Y')`"
output:
    bookdown::html_document2:
          number_sections: false
          theme: yeti
    
linkcolor: black
urlcolor: blue
link-citations: yes
---

<style type="text/css">

h1 {
  font-size: 38px;
  text-align: center;
}
h4.author { /* Header 4 - and the author and data headers use this too  */
    font-size: 18px;
  text-align: center;
}
h4.date { /* Header 4 - and the author and data headers use this too  */
  font-size: 18px;
  text-align: center;
}
</style>


\newpage

\setcounter{tocdepth}{2}
\renewcommand{\contentsname}{Tabla de contenidos}
\tableofcontents

\newpage

```{r setup, include=FALSE}
knitr::opts_chunk$set(comment=NA, prompt=FALSE, cache=FALSE, echo=FALSE, results='asis', message = F, warning = F)
summarytools::st_options(bootstrap.css     = FALSE,
           plain.ascii       = FALSE,   
           style             = "rmarkdown",
           dfSummary.silent  = TRUE, 
           footnote          = NA,
           subtitle.emphasis = FALSE,
           headings =  F,
           lang =  "es")
summarytools::st_css()

```

```{r packages}

if (!require("pacman")) install.packages("pacman")  #si falta pacman, instalar
if (!require("tinytex")) install.packages("tinytex")#si falta tinytex, instalar
pacman::p_load(knitr, summarytools, kableExtra, dplyr, lavaan, haven, htmlwidgets, webshot, sjPlot, VIM, GGally, finalfit, table1, psych, ordinal, MASS, brant, interaction) # librerias
knitr::opts_chunk$set(warning = FALSE,  # mensaje de warning
                      message = FALSE,  # mensajes/avisos de librerias  
                      cache = FALSE,    # cache de los chunks,usar analisis pesados
                      out.width = '85%',# largo de imagen en %
                      fig.pos= "H",     # posicion figuras H = HERE
                      echo = FALSE      # incluir chunk en output
)

# Otras configuraciones
options(scipen=999) # notacion cientifica
options(knitr.kable.NA = '') # NA en kable = ''

```

# Introducción

El presente documento corresponde al análisis deascriptivo de los datos la tesis llamada "¿Quién justifica qué? El rol del sentido de injusticia en las justificaciones de violencia en contexto de protesta".


Primero se comienza cargando los paquetes y la base de datos.

## Modelos para reporte

```{r load data}

load("../input/data/procjv_analysis.RData")

load("../input/data/procjv_analysis_nona.RData")

load("../input/data/procjv_nums_nona.RData")
```


### Justificación estudiantes lancen piedras


```{r jv-est-model, echo=FALSE, results='asis', cache = T}

load("../input/data/procjv_analysis_nona.RData")

jv_est_2019.modelmulpub1 <- clm(jv_est_2019_factor ~ 
                                  sj_ceo + 
                                  sj_obrero_rec + 
                                  sj_entrevistado, 
                                data = procjv_analysis_nona)
 
 jv_est_2019.modelmulpub2<- clm(jv_est_2019_factor ~ 
                                  sj_ceo + 
                                  sj_obrero_rec + 
                                  sj_entrevistado + 
                                  ingreso + 
                                  sexo_factor + 
                                  ingreso_satisfact_factor + 
                                  educ_rec_factor + 
                                  indigena_rec_factor, 
                                data = procjv_analysis_nona)
 
jv_est_2019.modelmulpub3<- clm(jv_est_2019_factor ~ 
                                 sj_ceo + 
                                 sj_obrero_rec + 
                                 sj_entrevistado + 
                                 ingreso + 
                                 sexo_factor + 
                                 ingreso_satisfact_factor + 
                                 educ_rec_factor + 
                                 indigena_rec_factor + 
                                 sdo_indice + 
                                 rwa_indice, 
                               data = procjv_analysis_nona)
  
jv_est_2019.modelmulpub4<- clm(jv_est_2019_factor ~ 
                                 sj_ceo + 
                                 sj_obrero_rec + 
                                 sj_entrevistado + 
                                 ingreso + 
                                 sexo_factor + 
                                 ingreso_satisfact_factor + 
                                 educ_rec_factor + 
                                 indigena_rec_factor + 
                                 sdo_indice + 
                                 rwa_indice + 
                                 trato_salud_factor + 
                                 trato_carab_factor, 
                               data = procjv_analysis_nona)

jv_est_2019.modelmulpub5<- clm(jv_est_2019_factor ~ 
                                 sj_ceo + 
                                 sj_obrero_rec + 
                                 sj_entrevistado + 
                                 ingreso + 
                                 sexo_factor + 
                                 ingreso_satisfact_factor + 
                                 educ_rec_factor + 
                                 indigena_rec_factor + 
                                 sdo_indice + 
                                 rwa_indice + 
                                 trato_salud_factor + 
                                 trato_carab_factor + 
                                 sexo_factor*sj_ceo + 
                                 ingreso_satisfact_factor*sj_ceo, 
                               data = procjv_analysis_nona)

jv_est_2019.modelmulpub6<- clm(jv_est_2019_factor ~ 
                                 sj_ceo + 
                                 sj_obrero_rec + 
                                 sj_entrevistado + 
                                 ingreso + 
                                 sexo_factor + 
                                 ingreso_satisfact_factor + 
                                 educ_rec_factor + 
                                 indigena_rec_factor + 
                                 sdo_indice + rwa_indice + 
                                 trato_salud_factor + 
                                 trato_carab_factor + 
                                 sexo_factor*sj_ceo + 
                                 ingreso_satisfact_factor*sj_ceo + 
                                 pos_pol_rec_factor + 
                                 frec_marcha_factor + 
                                 conf_carab_factor, 
                               data = procjv_analysis_nona)
```


### Justificación carabineros repriman marchas


```{r jv-carab1-model, echo=FALSE, results='asis', cache = T}

jv_carab1_2019.modelmulpub1 <- clm(jv_carab1_2019_factor ~ 
                                     sj_ceo + 
                                     sj_obrero_rec + 
                                     sj_entrevistado, 
                                   data = procjv_analysis_nona)
 
 jv_carab1_2019.modelmulpub2<- clm(jv_carab1_2019_factor ~ 
                                     sj_ceo + 
                                     sj_obrero_rec + 
                                     sj_entrevistado + 
                                     ingreso + 
                                     sexo_factor + 
                                     ingreso_satisfact_factor + 
                                     educ_rec_factor + 
                                     indigena_rec_factor, 
                                   data = procjv_analysis_nona)
 
jv_carab1_2019.modelmulpub3<- clm(jv_carab1_2019_factor ~ 
                                    sj_ceo + 
                                    sj_obrero_rec + 
                                    sj_entrevistado + 
                                    ingreso + 
                                    sexo_factor + 
                                    ingreso_satisfact_factor + 
                                    educ_rec_factor + 
                                    indigena_rec_factor + 
                                    sdo_indice + 
                                    rwa_indice, 
                                  data = procjv_analysis_nona)
  
jv_carab1_2019.modelmulpub4<- clm(jv_carab1_2019_factor ~ 
                                    sj_ceo + 
                                    sj_obrero_rec + 
                                    sj_entrevistado + 
                                    ingreso + 
                                    sexo_factor + 
                                    ingreso_satisfact_factor + 
                                    educ_rec_factor + 
                                    indigena_rec_factor + 
                                    sdo_indice + 
                                    rwa_indice + 
                                    trato_salud_factor + 
                                    trato_carab_factor, 
                                  data = procjv_analysis_nona)

jv_carab1_2019.modelmulpub5<- clm(jv_carab1_2019_factor ~ 
                                    sj_ceo + 
                                    sj_obrero_rec + 
                                    sj_entrevistado + 
                                    ingreso + 
                                    sexo_factor + 
                                    ingreso_satisfact_factor + 
                                    educ_rec_factor + 
                                    indigena_rec_factor + 
                                    sdo_indice + 
                                    rwa_indice + 
                                    trato_salud_factor + 
                                    trato_carab_factor + 
                                    educ_rec_factor*sj_obrero_rec, 
                                  data = procjv_analysis_nona)

jv_carab1_2019.modelmulpub6<- clm(jv_carab1_2019_factor ~ 
                                    sj_ceo + 
                                    sj_obrero_rec + 
                                    sj_entrevistado + 
                                    ingreso + 
                                    sexo_factor + 
                                    ingreso_satisfact_factor + 
                                    educ_rec_factor + 
                                    indigena_rec_factor + 
                                    sdo_indice + 
                                    rwa_indice + 
                                    trato_salud_factor + 
                                    trato_carab_factor + 
                                    educ_rec_factor*sj_obrero_rec + 
                                    pos_pol_rec_factor + 
                                    frec_marcha_factor + 
                                    conf_carab_factor, 
                                  data = procjv_analysis_nona)

```

### Justificación carabineros desalojen tomas

```{r jv-carab2-model, echo=FALSE, results='asis', cache = T}

 jv_carab2_2019.modelmulpub1 <- clm(jv_carab2_2019_factor ~ 
                                      sj_ceo + 
                                      sj_obrero_rec + 
                                      sj_entrevistado_rec, 
                                    data = procjv_analysis_nona)
 
 jv_carab2_2019.modelmulpub2<- clm(jv_carab2_2019_factor ~ 
                                     sj_ceo +
                                     sj_obrero_rec + 
                                     sj_entrevistado_rec +
                                     ingreso + 
                                     sexo_factor + 
                                     ingreso_satisfact_factor + 
                                     educ_rec_factor +
                                     indigena_rec_factor,
                                   data = procjv_analysis_nona)
 
jv_carab2_2019.modelmulpub3<- clm(jv_carab2_2019_factor ~ 
                                    sj_ceo + 
                                    sj_obrero_rec + 
                                    sj_entrevistado_rec + 
                                    ingreso +
                                    sexo_factor + 
                                    ingreso_satisfact_factor +
                                    educ_rec_factor + 
                                    indigena_rec_factor + 
                                    sdo_indice + 
                                    rwa_indice, 
                                  data = procjv_analysis_nona)
  
jv_carab2_2019.modelmulpub4<- clm(jv_carab2_2019_factor ~ 
                                    sj_ceo + 
                                    sj_obrero_rec +
                                    sj_entrevistado_rec + 
                                    ingreso +
                                    sexo_factor + 
                                    ingreso_satisfact_factor + 
                                    educ_rec_factor +
                                    indigena_rec_factor +
                                    sdo_indice + 
                                    rwa_indice + 
                                    trato_salud_factor +
                                    trato_carab_factor, 
                                  data = procjv_analysis_nona)

jv_carab2_2019.modelmulpub5<- clm(jv_carab2_2019_factor ~ 
                                    sj_ceo + 
                                    sj_obrero_rec + 
                                    sj_entrevistado_rec + 
                                    ingreso +
                                    sexo_factor + 
                                    ingreso_satisfact_factor +
                                    educ_rec_factor + 
                                    indigena_rec_factor + 
                                    sdo_indice + 
                                    rwa_indice +
                                    trato_salud_factor + 
                                    trato_carab_factor + 
                                    ingreso*sj_obrero_rec + 
                                    ingreso_satisfact_factor*sj_obrero_rec,
                                  data = procjv_analysis_nona)

jv_carab2_2019.modelmulpub6<- clm(jv_carab2_2019_factor ~ 
                                    sj_ceo + 
                                    sj_obrero_rec + 
                                    sj_entrevistado_rec + 
                                    ingreso + 
                                    sexo_factor + 
                                    ingreso_satisfact_factor + 
                                    educ_rec_factor +
                                    indigena_rec_factor +
                                    sdo_indice + 
                                    rwa_indice + 
                                    trato_salud_factor + 
                                    trato_carab_factor + 
                                    ingreso*sj_obrero_rec + 
                                    ingreso_satisfact_factor*sj_obrero_rec +
                                    pos_pol_rec_factor +
                                    frec_marcha_factor + 
                                    conf_carab_factor, 
                                  data = procjv_analysis_nona)
```



```{r}

plot_it1<- plot_model(jv_est_2019.modelmulpub5, type = "pred", terms = c("sexo_factor", "sj_ceo"), mdrt.values = "meansd", title = "")  + geom_line() + theme(legend.position="bottom") + ylab("Probabilidad Predicha")


plot_it1$data$response.level[plot_it1$data$response.level == 1] <- "1. Nunca"
plot_it1$data$response.level[plot_it1$data$response.level == 2] <- "2. Pocas veces"
plot_it1$data$response.level[plot_it1$data$response.level == 3] <- "3. Algunas veces"
plot_it1$data$response.level[plot_it1$data$response.level == 4] <- "4. Muchas veces"
plot_it1$data$response.level[plot_it1$data$response.level == 5] <- "5. Siempre"

plot_it1$data$group <- factor(plot_it1$data$group, levels = c(0.13, 1.13, 2.13), labels = c("Media-DE","Media","Media+DE"))
plot_it1$data$group_col <- factor(plot_it1$data$group_col, levels = c(0.13, 1.13, 2.13), labels = c("Media-DV","Media","Media+DV"))

plot_it1


plot_model(jv_est_2019.modelmulpub5, type = "pred", terms = c("ingreso_satisfact_factor")) + geom_line()
plot_model(jv_est_2019.modelmulpub5, type = "pred", terms = c("ingreso_satisfact_factor", "sj_ceo"), mdrt.values = "meansd") + geom_line()
```

```{r}

plot_pred_jvest <- plot_model(jv_est_2019.modelmulpub4, type = "pred", terms = c("sj_ceo[all]"), title = "")  + geom_line() + theme(legend.position="bottom") + ylab("Probabilidad Predicha")

plot_pred_jvest$data$response.level[plot_pred_jvest$data$response.level == 1] <- "1. Nunca"
plot_pred_jvest$data$response.level[plot_pred_jvest$data$response.level == 2] <- "2. Pocas veces"
plot_pred_jvest$data$response.level[plot_pred_jvest$data$response.level == 3] <- "3. Algunas veces"
plot_pred_jvest$data$response.level[plot_pred_jvest$data$response.level == 4] <- "4. Muchas veces"
plot_pred_jvest$data$response.level[plot_pred_jvest$data$response.level == 5] <- "5. Siempre"

plot_pred_jvest


```

```{r}

plot_pred_carab1 <- plot_model(jv_carab1_2019.modelmulpub2, type = "pred", terms = c("sj_obrero_rec[all]"), title = "")  + geom_line() + theme(legend.position="bottom") + ylab("Probabilidad Predicha")

plot_pred_carab1$data$response.level[plot_pred_carab1$data$response.level == 1] <- "1. Nunca"
plot_pred_carab1$data$response.level[plot_pred_carab1$data$response.level == 2] <- "2. Pocas veces"
plot_pred_carab1$data$response.level[plot_pred_carab1$data$response.level == 3] <- "3. Algunas veces"
plot_pred_carab1$data$response.level[plot_pred_carab1$data$response.level == 4] <- "4. Muchas veces"
plot_pred_carab1$data$response.level[plot_pred_carab1$data$response.level == 5] <- "5. Siempre"

plot_pred_carab1


```

```{r}

plot_pred_carab2 <- plot_model(jv_carab2_2019.modelmulpub4, type = "pred", terms = c("sj_obrero_rec[all]"), title = "")  + geom_line() + theme(legend.position="bottom") + ylab("Probabilidad Predicha")

plot_pred_carab2$data$response.level[plot_pred_carab2$data$response.level == 1] <- "1. Nunca"
plot_pred_carab2$data$response.level[plot_pred_carab2$data$response.level == 2] <- "2. Pocas veces"
plot_pred_carab2$data$response.level[plot_pred_carab2$data$response.level == 3] <- "3. Algunas veces"
plot_pred_carab2$data$response.level[plot_pred_carab2$data$response.level == 4] <- "4. Muchas veces"
plot_pred_carab2$data$response.level[plot_pred_carab2$data$response.level == 5] <- "5. Siempre"

plot_pred_carab2


```


## Test de supuesto de proporcionalidad

```{r}
## JV est
### Model SJ

 jv_est_2019.test1 <- polr(jv_est_2019_factor ~ sj_ceo + sj_obrero_rec + sj_entrevistado_rec, data = procjv_analysis_nona, Hess = TRUE)
 

### Model complete

# jv_est_2019.test2<- polr(jv_est_2019_factor ~ sj_ceo + sj_obrero_rec + sj_entrevistado_rec + ingreso + sexo_factor + ingreso_satisfact_factor + educ_rec_factor + indigena_rec_factor + sdo_indice + rwa_indice + trato_salud_factor + trato_carab_factor + sj_ceo*sexo_factor + sj_ceo*ingreso_satisfact_factor + pos_pol_rec_factor + frec_marcha_factor + conf_carab_factor, data = procjv_analysis_nona , Hess = TRUE)


## JV carab1
### Model SJ

 jv_carab1_2019.test1 <- polr(jv_carab1_2019_factor ~ sj_ceo + sj_obrero_rec + sj_entrevistado_rec, data = procjv_analysis_nona, Hess = TRUE)

### Model complete
 
 # jv_carab1_2019.test2<- polr(jv_carab1_2019_factor ~ sj_ceo + sj_obrero_rec + sj_entrevistado_rec + ingreso + sexo_factor + ingreso_satisfact_factor + educ_rec_factor + indigena_rec_factor + sdo_indice + rwa_indice + trato_salud_factor + trato_carab_factor + sj_obrero*educ_rec_factor + pos_pol_rec_factor + frec_marcha_factor + conf_carab_factor, data = procjv_analysis_nona, Hess = TRUE)

## JV carab2
### Model SJ
 
  jv_carab2_2019.test1<- polr(jv_carab2_2019_factor ~ sj_ceo + sj_obrero_rec + sj_entrevistado_rec, data = procjv_analysis_nona, Hess = TRUE)
 

### Model complete
  
# jv_carab2_2019.test2<- polr(jv_carab2_2019_factor ~ sj_ceo + sj_obrero_rec + sj_entrevistado_rec + ingreso + sexo_factor + ingreso_satisfact_factor + educ_rec_factor + indigena_rec_factor + sdo_indice + rwa_indice + trato_salud_factor + trato_carab_factor + sj_ceo*ingreso + sj_ceo*ingreso_satisfact_factor + sj_entrevistado*ingreso + sj_entrevistado*ingreso_satisfact_factor + pos_pol_rec_factor + frec_marcha_factor + conf_carab_factor, data = procjv_analysis_nona, Hess = TRUE)


brant(jv_est_2019.test1)
# brant(jv_est_2019.test2)

brant(jv_carab1_2019.test1)
# brant(jv_carab1_2019.test2)

brant(jv_carab2_2019.test1)

# brant(jv_carab2_2019.test2)
```